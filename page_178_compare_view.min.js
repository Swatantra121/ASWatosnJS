var g_compareColObj={},regex=/(\w+)-#([0-9A-Fa-f]{6})/g,g_select_item_color_change=$v("P178_POGCR_BLINK_COLOR_CHANGE"),g_isReportRender="N",g_item_vertical_text_display=$v("P178_ITEM_CODE_VERT_ALN"),g_item_text_center_align=$v("P178_ITEM_CODE_CTR_ALN");function init(e){try{var t="maincanvas";(e=parseInt(e))>0&&(t="maincanvas"+(e+1)),g_canvas=document.getElementById(t),g_canvas.setAttribute("data-indx",e),g_canvas_region=document.getElementById("drawing_region"),g_selection=document.getElementById("selection"),g_canvas_objects.push(g_canvas)}catch(e){return void(document.getElementById("canvas-holder").innerHTML="<p><b>Sorry, an error occurred:<br>"+e+"</b></p>")}createWorld(),g_raycaster=new THREE.Raycaster,render(),multiselect="N",ctrl_select="N";var o=window.devicePixelRatio;g_start_pixel_ratio=o,g_windowHeight=window.innerHeight,windowWidth=$("#drawing_region").innerWidth()/2,setUpMouseHander("maincanvas",doMouseMove,g_canvas),g_tanFOV=Math.tan(Math.PI/180*g_camera.fov/2),g_initial_windowHeight=window.innerHeight;var n=$("#"+t).parent()[0].offsetHeight,s=$("#"+t).parent()[0].offsetWidth,_=n;$("#"+t).css("height",_+"px !important").css("width",s+"px !important"),g_canvas.width=s,g_canvas.height=_,g_camera.aspect=s/_,g_camera.fov=360/Math.PI*Math.atan(g_tanFOV),g_camera.updateProjectionMatrix(),g_renderer.setSize(s,_)}function setUpMouseHander(e,t,o){try{if("string"==typeof e&&(e=document.getElementById(e)),!e||!e.addEventListener)throw"first argument in setUpMouseHander is not a valid element";var n,s;o.addEventListener("mousemove",(function(e){if(t){var _=o.getAttribute("id"),l=o,a=l.getAttribute("data-indx"),i=g_camera;"CANVAS"==e.target.nodeName&&void 0!==g_scene_objects[a]?(a=(l=e.target).getAttribute("data-indx"),g_scene_objects.length>0&&(i=g_scene_objects[a].scene.children[0])):(l=e.target,a=0,i=g_camera);var r=l.getBoundingClientRect(),g=(r.height,e.clientX-r.left),c=e.clientY-r.top;NEW_POGJSON=g_pog_json,t(g,c,e,n,s,l,NEW_POGJSON,_,a,i)}n=g,s=c}))}catch(e){error_handling(e)}}function doMouseMove(e,t,o,n,s,_,l,a,r,g){try{var c=_.width/window.devicePixelRatio,I=_.height/window.devicePixelRatio,d=2*e/c-1,f=1-2*t/I,p=$(document).scrollTop(),u=$(".t-Region-body").scrollLeft();g.updateProjectionMatrix(),g_raycaster.setFromCamera(new THREE.Vector2(d,f),g),void 0!==g_scene_objects[r]?g_intersects=g_raycaster.intersectObjects(g_scene_objects[r].scene.children[2].children):g_intersects=g_raycaster.intersectObjects(g_world.children);var h=$(document),m=$(window),O=$("#object_info"),j=O.offset(),v=j.top-h.scrollTop(),P=(m.height(),O.height(),j.left-h.scrollLeft());m.width(),O.width();g_mouse.x=o.clientX+u-20,g_mouse.y=o.clientY+p;var E=g_startMouse.x,C=g_mouse.x,b=g_startMouse.y,L=g_mouse.y;if(E>C){var D=E;E=C,C=D}if(b>L){var S=b;b=L,L=S}if(g_dragging){g_raycaster.setFromCamera(new THREE.Vector2(d,f),g),g_intersects=g_raycaster.intersectObject(g_targetForDragging);g_drag_z;var T=g_intersects[0].point.x,R=g_intersects[0].point.y,y=g_intersects[0].point.z,M=new THREE.Vector3(T,R,y);g_scene_objects[r].scene.children[2].worldToLocal(M),d=Math.min(19,Math.max(-19,M.x)),t=Math.min(19,Math.max(-19,M.y)),g_selecting&&(g_multiselect="Y",g_DragMouseEnd.x=d,g_DragMouseEnd.y=t,g_selection.style.left=E+"px",g_selection.style.top=b+"px",g_selection.style.width=C-E-5+"px",g_selection.style.height=L-b-5+"px",console.log("g_selection.style.left",g_selection.style.left,g_selection.style.top,g_selection.style.width)),g_DragMouseEnd.x=d,g_DragMouseEnd.y=t}else g_selecting&&(g_selecting=!1,g_selection.style.visibility="hidden");var w=document.getElementById("object_info");$("#object_info").contents().filter((function(){return 3==this.nodeType})).remove();var G="",A=0,x=[],N=" | ";if(g_intersects.length>0&&void 0!==g_intersects[0].object.ItemID&&""!==g_intersects[0].object.ItemID&&"DIVIDER"!==g_intersects[0].object.ItemID){var B=$v("P178_POGCR_ITEM_DESC_LIST").split(":");for(i=0;i<B.length;i++){var F=0;N=i>0?" | ":"";"ITEM"==B[i]&&(G=G+N+get_message("ITEM_ID")+': <span style="color:yellow">'+g_intersects[0].object.ItemID+"</span>",F=(" | "+get_message("ITEM_ID")+": "+g_intersects[0].object.ItemID).visualLength("ruler")),"UPC"==B[i]&&(G=G+N+get_message("POGCR_REP_TEMP_HEAD_BARCODE")+': <span style="color:yellow">'+g_intersects[0].object.Barcode+"</span>",F=(" | "+get_message("POGCR_REP_TEMP_HEAD_BARCODE")+": "+g_intersects[0].object.Barcode).visualLength("ruler")),"DESC"==B[i]&&(G=G+N+get_message("DESCRIPTION")+': <span style="color:yellow">'+g_intersects[0].object.Description+"</span>",F=(" | "+get_message("DESCRIPTION")+": "+g_intersects[0].object.Description).visualLength("ruler")),"BRAND"==B[i]&&(G=G+N+get_message("POGCR_BRAND")+': <span style="color:yellow">'+g_intersects[0].object.Brand+"</span>",F=(" | "+get_message("POGCR_BRAND")+": "+g_intersects[0].object.Brand).visualLength("ruler")),"GROUP"==B[i]&&(G=G+N+get_message("POGCR_GROUP_LBL")+': <span style="color:yellow">'+g_intersects[0].object.Group+"</span>",F=(" | "+get_message("POGCR_GROUP_LBL")+": "+g_intersects[0].object.Group).visualLength("ruler")),"DEPT"==B[i]&&(G=G+N+get_message("POGCR_TEMP_HEAD_DEPARTMENT")+': <span style="color:yellow">'+g_intersects[0].object.Dept+"</span>",F=(" | "+get_message("POGCR_TEMP_HEAD_DEPARTMENT")+": "+g_intersects[0].object.Dept).visualLength("ruler")),"CLASS"==B[i]&&(G=G+N+get_message("POGCR_CLASS_LBL")+': <span style="color:yellow">'+g_intersects[0].object.Class+"</span>",F=(" | "+get_message("POGCR_CLASS_LBL")+": "+g_intersects[0].object.Class).visualLength("ruler")),"SUBCLASS"==B[i]&&(G=G+N+get_message("POGCR_SUBCLASS_LBL")+': <span style="color:yellow">'+g_intersects[0].object.SubClass+"</span>",F=(" | "+get_message("POGCR_SUBCLASS_LBL")+": "+g_intersects[0].object.SubClass).visualLength("ruler")),"ITEM_SIZE"==B[i]&&(G=G+N+get_message("POGCR_ITEMSIZE_LBL")+': <span style="color:yellow">'+g_intersects[0].object.SizeDesc+"</span>",F=(" | "+get_message("POGCR_ITEMSIZE_LBL")+": "+g_intersects[0].object.SizeDesc).visualLength("ruler")),"SUPPLIER"==B[i]&&(G=G+N+get_message("POGCR_REP_HEAD_SUPPLIERS")+': <span style="color:yellow">'+g_intersects[0].object.Supplier+"</span>",F=(" | "+get_message("POGCR_REP_HEAD_SUPPLIERS")+": "+g_intersects[0].object.Supplier).visualLength("ruler")),"WIDTH"==B[i]&&(G=G+N+get_message("POGCR_WIDTH_LBL")+': <span style="color:yellow">'+(100*g_intersects[0].object.OW).toFixed(2)+"</span>",F=(" | "+get_message("POGCR_WIDTH_LBL")+": "+(100*g_intersects[0].object.OW).toFixed(2)).visualLength("ruler")),"HEIGHT"==B[i]&&(G=G+N+get_message("POGCR_HEIGHT_LBL")+': <span style="color:yellow">'+(100*g_intersects[0].object.OH).toFixed(2)+"</span>",F=(" | "+get_message("POGCR_HEIGHT_LBL")+": "+(100*g_intersects[0].object.OH).toFixed(2)).visualLength("ruler")),"DEPTH"==B[i]&&(G=G+N+get_message("POGCR_DEPTH_LBL")+': <span style="color:yellow">'+(100*g_intersects[0].object.OD).toFixed(2)+"</span>",F=(" | "+get_message("POGCR_DEPTH_LBL")+": "+(100*g_intersects[0].object.OD).toFixed(2)).visualLength("ruler")),"STORE"==B[i]&&(G=G+N+get_message("POGCR_STORE_LBL")+': <span style="color:yellow">'+g_intersects[0].object.StoreCnt+"</span>",F=(" | "+get_message("POGCR_STORE_LBL")+": "+g_intersects[0].object.StoreCnt).visualLength("ruler")),"ITEM_DIM"==B[i]&&(G=G+N+get_message("POGCR_ITEM_DIM_LBL")+': <span style="color:yellow">'+g_intersects[0].object.ItemDim+"</span>",F=(" | "+get_message("POGCR_ITEM_DIM_LBL")+": "+g_intersects[0].object.ItemDim).visualLength("ruler")),"POSITION"==B[i]&&(G=G+N+get_message("POGCR_POSITION_LBL")+': <span style="color:yellow">'+g_intersects[0].object.LocID+"</span>",F=(" | "+get_message("POGCR_POSITION_LBL")+": "+g_intersects[0].object.LocID).visualLength("ruler")),"SHELF"==B[i]&&(G=G+N+get_message("POGCR_SHELF_LBL")+': <span style="color:yellow">'+g_intersects[0].object.Shelf+"</span>",F=(" | "+get_message("POGCR_SHELF_LBL")+": "+g_intersects[0].object.Shelf).visualLength("ruler")),"ORIENTATION"==B[i]&&(G=G+N+get_message("POGCR_ORIENTATION_LBL")+': <span style="color:yellow">'+g_intersects[0].object.OrientationDesc+"</span>",F=(" | "+get_message("POGCR_ORIENTATION_LBL")+": "+g_intersects[0].object.OrientationDesc).visualLength("ruler")),"DEPTH_FACING"==B[i]&&(G=G+N+get_message("POGCR_DEPTH_FACING_LBL")+': <span style="color:yellow">'+g_intersects[0].object.DFacing+"</span>",F=(" | "+get_message("POGCR_DEPTH_FACING_LBL")+": "+g_intersects[0].object.DFacing).visualLength("ruler")),"HORIZ_FACING"==B[i]&&(G=G+N+get_message("TEMP_HEAD_HORIZ_FACING")+': <span style="color:yellow">'+g_intersects[0].object.HorizFacing+"</span>",F=(" | "+get_message("TEMP_HEAD_HORIZ_FACING")+": "+g_intersects[0].object.HorizFacing).visualLength("ruler")),"VERT_FACING"==B[i]&&(G=G+N+get_message("TEMP_HEAD_VERT_FACING")+': <span style="color:yellow">'+g_intersects[0].object.VertFacing+"</span>",F=(" | "+get_message("TEMP_HEAD_VERT_FACING")+": "+g_intersects[0].object.VertFacing).visualLength("ruler")),"SELLING_PRICE"==B[i]&&(G=G+N+get_message("SELLING_PRICE_LBL")+': <span style="color:yellow">'+parseFloat(g_intersects[0].object.SellingPrice).toFixed(2)+"</span>",F=(" | "+get_message("SELLING_PRICE_LBL")+": "+g_intersects[0].object.SellingPrice).visualLength("ruler")),"SALES_UNIT"==B[i]&&(G=G+N+get_message("SALES_UNIT_LBL")+': <span style="color:yellow">'+parseFloat(g_intersects[0].object.SalesUnit).toFixed(2)+"</span>",F=(" | "+get_message("SALES_UNIT_LBL")+": "+g_intersects[0].object.SalesUnit).visualLength("ruler")),"NET_SALES"==B[i]&&(G=G+N+get_message("NET_SALES_LBL")+': <span style="color:yellow">'+parseFloat(g_intersects[0].object.NetSales).toFixed(2)+"</span>",F=(" | "+get_message("NET_SALES_LBL")+": "+g_intersects[0].object.NetSales).visualLength("ruler")),"PROFIT"==B[i]&&(G=G+N+get_message("PROFIT_LBL")+': <span style="color:yellow">'+parseFloat(g_intersects[0].object.Profit).toFixed(2)+"</span>",F=(" | "+get_message("PROFIT_LBL")+": "+g_intersects[0].object.Profit).visualLength("ruler")),"TOTAL_MARGIN"==B[i]&&(G=G+N+get_message("POGCR_TOTAL_MARGIN")+': <span style="color:yellow">'+parseFloat(g_intersects[0].object.TotalMargin).toFixed(2)+"</span>",F=(" | "+get_message("POGCR_TOTAL_MARGIN")+": "+g_intersects[0].object.TotalMargin).visualLength("ruler")),(A+=F)>1300&&(G+="<br>",x.push(A),A=0)}}else if(g_intersects.length>0&&void 0!==g_intersects[0].object.FixelID&&""!==g_intersects[0].object.FixelID){var H=void 0!==l[r].Version&&null!==l[r].Version?l[r].Version:"",V="",Y=N+get_message("POGCR_POG_VERSION")+': <span style="color:yellow">'+H+" </span> ";G=G+get_message("POGCR_POG_CODE")+': <span style="color:yellow">'+l[r].POGCode+" </span> "+Y+V+N+get_message("POGCR_POG_MOD")+': <span style="color:yellow">'+g_intersects[0].object.Module+" </span> "+N+get_message("POGCR_FIXEL_ID")+': <span style="color:yellow">'+g_intersects[0].object.FixelID+"</span>",w.classList.add("active")}else if(g_intersects.length>0&&void 0!==g_intersects[0].object.Module&&""!==g_intersects[0].object.Module){H=void 0!==l[r].Version&&null!==l[r].Version?l[r].Version:"",V="",Y=N+get_message("POGCR_POG_VERSION")+': <span style="color:yellow">'+H+" </span> ";G=G+get_message("POGCR_POG_CODE")+': <span style="color:yellow">'+l[r].POGCode+" </span> "+Y+V+N+get_message("POGCR_POG_MOD")+': <span style="color:yellow">'+g_intersects[0].object.Module+"</span>",w.classList.add("active")}else if(void 0!==l&&l.length>0){H=void 0!==l[r].Version&&null!==l[r].Version?l[r].Version:"",V="",Y=N+get_message("POGCR_POG_VERSION")+': <span style="color:yellow">'+H+" </span> ";G=G+get_message("POGCR_POG_CODE")+': <span style="color:yellow">'+l[r].POGCode+" </span> "+Y+V,w.classList.add("active")}else w.classList.remove("active");if(G=G+'<br>Version Compare color details : <span style="color: #'+g_compareColObj.ADD+'">Added Product</span> '+N+' <span style="color: #'+g_compareColObj.RETAIN_CHANGE+'">Retain Product with position change</span> '+N+' <span style="color: #'+g_compareColObj.RETAIN+'">Retain with no change</span> '+N+' <span style="color: #'+g_compareColObj.REMOVE+'">Deleted Product</span> '+N+' <span style="color: #'+g_compareColObj.NEW+'">New Products</span>',g_intersects.length>0)if(void 0!==g_intersects[0].object.ItemID&&""!==g_intersects[0].object.ItemID&&"DIVIDER"!==g_intersects[0].object.ItemID){I=G.visualHeight("ruler")+12;var k=B.length>7?150:50;if(x.length>0)c=Math.max.apply(Math,x)+k;else c=G.visualLength("ruler")+k}else I=G.visualHeight("ruler")+7,c=G.visualLength("ruler")+50;else I=G.visualHeight("ruler")+7,c=G.visualLength("ruler")+50;$("#object_info").html(G),w.style.top=window.innerHeight-O.height()-15+"px",w.style.width=window.innerWidth+"px",w.style.height=I+"px",w.style.fontSize="large",w.style.fontFamily="Tahoma",w.style.left="0px"}catch(e){error_handling(e)}}async function create_module_from_json(e,t,o,n,s,_,l,a,i,r,g,c){try{$("#LIVE_IMAGE").addClass("apex_disabled"),"Y"==$v("P178_POGCR_DFT_NOTCH_LABEL")&&(g_show_notch_label="Y"),"Y"==$v("P178_POGCR_DFT_FIXEL_LABEL")&&(g_show_fixel_label="Y"),"Y"==$v("P178_POGCR_SHOW_DFLT_ITEM_LOC")&&(g_show_item_label="Y"),await load_orientation_json(),await create_module_from_json_lib(e,t,o,n,s,a,i,$v("P178_VDATE"),$v("P178_POG_DEFAULT_COLOR"),$v("P178_MODULE_DEFAULT_COLOR"),null,!1,g,c,$v("P178_POGCR_DFT_SPREAD_PRODUCT"),parseFloat($v("P178_PEGBOARD_DFT_HORZ_SPC")),parseFloat($v("P178_PEGBOARD_DFT_VERT_SPC")),parseFloat($v("P178_BASKET_WALL_THICK")),parseFloat($v("P178_CHEST_WALL_THICK")),$v("P178_POGCR_PEG_ITEM_AUTO_PLACE"),$v("P178_POGCR_DEFAULT_WRAP_TEXT"),parseInt($v("P178_POGCR_TEXT_DEFAULT_SIZE")),$v("P178_POG_TEXTBOX_DEFAULT_COLOR"),$v("P178_SHELF_DEFAULT_COLOR"),$v("P178_DIV_COLOR"),$v("P178_SLOT_DIVIDER"),$v("P178_SLOT_ORIENTATION"),$v("P178_DIVIDER_FIXED"),$v("P178_ITEM_DFT_COLOR"),$v("P178_POGCR_DELIST_ITEM_DFT_COLOR"),"Y",null,1,$v("P178_MERCH_STYLE"),$v("P178_POGCR_LOAD_IMG_FROM"),$v("P178_BU_ID"),$v("P178_POGCR_DELIST_ITEM_DFT_COLOR"),$v("P178_POGCR_ITEM_NUM_LBL_COLOR"),$v("P178_POGCR_DISPLAY_ITEM_INFO"),$v("P178_POGCR_ITEM_NUM_LBL_COLOR"),$v("P178_POGCR_ITEM_NUM_LABEL_POS"),$v("P178_NOTCH_HEAD"),"N",$v("P178_POGCR_DFT_BASKET_FILL"),$v("P178_POGCR_DFT_BASKET_SPREAD"),g_camera,r,null,$v("P178_POGCR_NOTCH_START_VALUE"),"N","Y","N"),("Y"==$v("P178_POGCR_DFT_ITEM_DESC")||0==g_ItemImages.length&&"Y"==$v("P178_POGCR_DFLT_LIVE_IMAGES"))&&(await showHideItemDescription("Y",$v("P178_ITEM_DFT_COLOR"),$v("P178_POGCR_DISPLAY_ITEM_INFO"),r),g_show_item_desc="Y","Y"==$v("P178_POGCR_DFT_ITEM_DESC")?g_show_live_image="N":g_show_live_image="Y"),animate_pog(r);var I=get_min_max_xy(r).split("###");set_camera_z(g_scene_objects[r].scene.children[0],parseFloat(I[2]),parseFloat(I[3]),parseFloat(I[0]),parseFloat(I[1]),g_offset_z,parseFloat(I[4]),parseFloat(I[5]),!0,r),render()}catch(e){error_handling(e)}return"SUCCESS"}function changeItemRepView(e){$s("P178_ITM_DISP_IDF",e),apex.region("item_detail_grid").refresh()}async function reset_colors(e,t){logDebug("function : reset_colors; resetType : "+e,"S"),"O"==e&&"N"==g_colorBackup&&"undefined"!=typeof g_pog_json&&g_pog_json.length>0?($.each(g_pog_json[t].ModuleInfo,(function(e,o){if(void 0===o.ParentModule||null==o.ParentModule){var n=o.ShelfInfo;g_pog_json[t].ModuleInfo[e].ShelfInfo;$.each(n,(function(o,n){$.each(n.ItemInfo,(function(n,s){g_pog_json[t].ModuleInfo[e].ShelfInfo[o].ItemInfo[n].OldItemColor=g_pog_json[t].ModuleInfo[e].ShelfInfo[o].ItemInfo[n].Color}))}))}})),g_colorBackup="Y"):"undefined"!=typeof g_pog_json&&g_pog_json.length>0&&($.each(g_pog_json[t].ModuleInfo,(function(e,o){if(void 0===o.ParentModule||null==o.ParentModule){var n=o.ShelfInfo;g_pog_json[t].ModuleInfo[e].ShelfInfo;$.each(n,(function(o,n){$.each(n.ItemInfo,(function(n,s){g_pog_json[t].ModuleInfo[e].ShelfInfo[o].ItemInfo[n].Color=g_pog_json[t].ModuleInfo[e].ShelfInfo[o].ItemInfo[n].OldItemColor}))}))}})),g_colorBackup="N"),render(t),logDebug("function : reset_colors","E")}async function ShowColorBackup(e){try{if(logDebug("function : ShowColorBackup","S"),void 0===g_pog_json[e].ColorBackup)$.each(g_pog_json[e].ModuleInfo,(function(t,o){if(void 0===o.ParentModule||null==o.ParentModule){var n=g_pog_json[e].ModuleInfo[t].Carpark,s=o.ShelfInfo,_=0;for(const o of s){var l=0;for(const n of o.ItemInfo){var a=g_pog_json[e].ModuleInfo[t].ShelfInfo[_].ItemInfo[l];a.ShowColorBackup=a.Color,g_pog_json[e].ColorBackup="Y",(i=g_scene_objects[e].scene.children[2].getObjectById(n.ObjID)).ShowColorBackup=i.material.color.getHex,l++}_++}if(void 0!==n&&n.length>0){l=0;for(const o of n[0].ItemInfo){var i;g_pog_json[e].ModuleInfo[t].Carpark[0].ItemInfo[l].ShowColorBackup=g_pog_json[e].ModuleInfo[t].Carpark[0].ItemInfo[l].Color,g_pog_json[e].ColorBackup="Y",(i=g_scene_objects[e].scene.children[2].getObjectById(o.ObjID)).ShowColorBackup=i.material.color.getHex,l++}}}render(e)}));else{var t=0;for(const g of g_pog_json[e].ModuleInfo){if(void 0===g.ParentModule||null==g.ParentModule){var o=g_pog_json[e].ModuleInfo[t].Carpark,n=g.ShelfInfo,s=0;for(const o of n){var _=0;for(const n of o.ItemInfo){var l=g_pog_json[e].ModuleInfo[t].ShelfInfo[s].ItemInfo[_];l.Color=l.ShowColorBackup;var a=g_scene_objects[e].scene.children[2].getObjectById(n.ObjID),i=l.Color.replace(/#/g,"0x");a.material.color.setHex(i);var r=a.children;for(m=0;m<r.length;m++)"horiz_facing"==r[m].uuid&&r[m].material.color.setHex(i);g_pog_json[e].ColorBackup="Y",_++}s++}if(void 0!==o&&o.length>0){_=0;for(const n of o[0].ItemInfo){g_pog_json[e].ModuleInfo[t].Carpark[0].ItemInfo[_].Color=g_pog_json[e].ModuleInfo[t].Carpark[0].ItemInfo[_].ShowColorBackup;a=g_scene_objects[e].scene.children[2].getObjectById(n.ObjID),i=g_pog_json[e].ModuleInfo[t].Carpark[0].ItemInfo[_].Color.replace(/#/g,"0x");a.material.color.setHex(i);r=a.children;for(m=0;m<r.length;m++)"horiz_facing"==r[m].uuid&&r[m].material.color.setHex(i);g_pog_json[e].ColorBackup="Y",_++}}}t++}render(e)}logDebug("function : ShowColorBackup","E")}catch(e){error_handling(e)}}async function two_pog_diff_checker(e,t){logDebug("function : two_pog_diff_checker","S");await reset_colors("O",e),await ShowColorBackup(e);var o=[],n=[],s=[],_=[],l=[],a=0,i=["SHELF","PALLET","HANGINGBAR","PEGBOARD"];g_world=g_scene_objects[e].scene.children[2],"undefined"!=typeof g_pog_json&&g_pog_json.length>0&&void 0!==g_pog_json[t].ModuleInfo&&($.each(g_pog_json[e].ModuleInfo,(function(e,s){var _="N";$.each(g_pog_json[t].ModuleInfo,(function(e,t){if(t.Module==s.Module){_="Y",t.ModuleFound="Y";var o=s.ShelfInfo,l=t.ShelfInfo;$.each(o,(function(e,t){if(-1!==i.indexOf(t.ObjType)){var o="N";$.each(l,(function(e,n){-1!==i.indexOf(n.ObjType)&&t.Shelf==n.Shelf&&(o="Y")})),"N"==o&&n.push(t.Shelf)}}))}})),"N"==_&&o.push(s.Module)})),$.each(g_pog_json[t].ModuleInfo,(function(t,o){$.each(o.ShelfInfo,(function(t,o){-1!==i.indexOf(o.ObjType)&&$.each(o.ItemInfo,(function(t,o){var n="N";$.each(g_pog_json[e].ModuleInfo,(function(e,t){$.each(t.ShelfInfo,(function(e,t){-1!==i.indexOf(t.ObjType)&&$.each(t.ItemInfo,(function(e,t){o.ItemID==t.ItemID&&(n="Y")}))}))})),"N"==n&&s.push(o.ItemID)}))}))})),$.each(g_pog_json[e].ModuleInfo,(function(e,o){$.each(o.ShelfInfo,(function(e,o){-1!==i.indexOf(o.ObjType)&&$.each(o.ItemInfo,(function(e,o){var n="N";$.each(g_pog_json[t].ModuleInfo,(function(e,t){$.each(t.ShelfInfo,(function(e,t){-1!==i.indexOf(t.ObjType)&&$.each(t.ItemInfo,(function(e,t){o.ItemID==t.ItemID&&(n="Y")}))}))})),"N"==n&&_.push(o.ItemID)}))}))})),$.each(g_pog_json[t].ModuleInfo,(function(t,o){$.each(o.ShelfInfo,(function(t,n){-1!==i.indexOf(n.ObjType)&&$.each(n.ItemInfo,(function(t,s){$.each(g_pog_json[e].ModuleInfo,(function(e,s){$.each(s.ShelfInfo,(function(e,_){$.each(_.ItemInfo,(function(e,i){o.Module==s.Module&&n.Shelf==_.Shelf&&(void 0!==_.ItemInfo[t]?n.ItemInfo[t].ItemID==_.ItemInfo[t].ItemID?"Y":(l[a]={},l[a].Module=s.Module,l[a].Shelf=_.Shelf,l[a].ItemID=_.ItemInfo[t].ItemID,a++):(l[a]={},l[a].Module=o.Module,l[a].Shelf=n.Shelf,l[a].ItemID=n.ItemInfo[t].ItemID,a++))}))}))}))}))}))})),$.each(g_pog_json[e].ModuleInfo,(function(e,o){$.each(o.ShelfInfo,(function(e,n){-1!==i.indexOf(n.ObjType)&&$.each(n.ItemInfo,(function(e,s){$.each(g_pog_json[t].ModuleInfo,(function(t,s){$.each(s.ShelfInfo,(function(t,_){$.each(_.ItemInfo,(function(t,i){o.Module==s.Module&&n.Shelf==_.Shelf&&(void 0!==_.ItemInfo[e]?n.ItemInfo[e].ItemID==_.ItemInfo[e].ItemID?"Y":(l[a]={},l[a].Module=s.Module,l[a].Shelf=_.Shelf,l[a].ItemID=_.ItemInfo[e].ItemID,a++):(l[a]={},l[a].Module=o.Module,l[a].Shelf=n.Shelf,l[a].ItemID=n.ItemInfo[e].ItemID,a++))}))}))}))}))}))})),$.each(g_pog_json[t].ModuleInfo,(function(e,o){$.each(o.ShelfInfo,(function(o,n){-1!==i.indexOf(n.ObjType)&&$.each(n.ItemInfo,(function(n,_){var l=g_scene_objects[t].scene.children[2].getObjectById(_.ObjID);-1!==s.indexOf(_.ItemID)?("N"==g_show_live_image&&l.material.color.setHex("0x"+g_compareColObj.REMOVE),g_pog_json[t].ModuleInfo[e].ShelfInfo[o].ItemInfo[n].Color="0x"+g_compareColObj.REMOVE):("N"==g_show_live_image&&l.material.color.setHex(16777215),g_pog_json[t].ModuleInfo[e].ShelfInfo[o].ItemInfo[n].Color="0xFFFFFF")}))}))})),render(t),$.each(g_pog_json[e].ModuleInfo,(function(t,o){$.each(o.ShelfInfo,(function(s,a){-1!==i.indexOf(a.ObjType)&&$.each(a.ItemInfo,(function(i,r){var g=!1;for(let e of l)if(e.ItemID==r.ItemID&&e.Shelf==a.Shelf&&e.Module==o.Module){g=!0;break}if(g||-1!==n.indexOf(a.Shelf)){var c=g_scene_objects[e].scene.children[2].getObjectById(r.ObjID);"N"==g_show_live_image&&c.material.color.setHex("0x"+g_compareColObj.RETAIN_CHANGE),g_pog_json[e].ModuleInfo[t].ShelfInfo[s].ItemInfo[i].Color="0x"+g_compareColObj.RETAIN_CHANGE}else{c=g_scene_objects[e].scene.children[2].getObjectById(r.ObjID);"N"==g_show_live_image&&c.material.color.setHex("0x"+g_compareColObj.RETAIN),g_pog_json[e].ModuleInfo[t].ShelfInfo[s].ItemInfo[i].Color="0x"+g_compareColObj.RETAIN}if(-1!==_.indexOf(r.ItemID)){c=g_scene_objects[e].scene.children[2].getObjectById(r.ObjID);"N"==g_show_live_image&&c.material.color.setHex("0x"+g_compareColObj.ADD),g_pog_json[e].ModuleInfo[t].ShelfInfo[s].ItemInfo[i].Color="0x"+g_compareColObj.ADD}if("Y"==r.NewYN){c=g_scene_objects[e].scene.children[2].getObjectById(r.ObjID);"N"==g_show_live_image&&c.material.color.setHex("0x"+g_compareColObj.NEW),g_pog_json[e].ModuleInfo[t].ShelfInfo[s].ItemInfo[i].Color="0x"+g_compareColObj.NEW}}))}))})),render(e)),logDebug("function : two_pog_diff_checker","E")}async function switchCanvasView(){var e,t=g_pog_index,o=$("[data-row]").length;colCount=$("[data-col]").length,e=$("#drawing_region").width(),$("#canvas-holder .container").height(),$("#canvas-holder .container").css("display","grid");for(var n=1;n<=o;n++){var s=$("[data-row="+n+"] [data-col]").length;$("[data-row="+n+"] .canvas-content").css("width",parseFloat((e/s).toFixed(2)))}if(g_pog_json.length>0){g_canvas_objects=[];for(n=1;n<=g_pog_json.length;n++){const e=g_renderer,t=g_scene_objects[n-1].scene,o=g_scene_objects[n-1].scene.children.find((e=>"PerspectiveCamera"===e.type));var _="maincanvas"+(1==n?"":n);g_canvas=document.getElementById(_);var l=$("#"+_).parent().height(),a=$("#"+_).parent().width(),i=l;$("#"+_).css("height",i+"px !important").css("width",a+"px !important"),$("#"+_).height(i),$("#"+_).width(a),g_canvas.width=a,g_canvas.height=i,g_canvas_objects.push($("#"+_)[0]);var r=Math.tan(Math.PI/180*o.fov/2);o.aspect=a/i,o.fov=360/Math.PI*Math.atan(r),o.updateProjectionMatrix(),e.setSize(a,i);var g=get_min_max_xy(n-1).split("###");set_camera_z(o,parseFloat(g[2]),parseFloat(g[3]),parseFloat(g[0]),parseFloat(g[1]),g_offset_z,parseFloat(g[4]),parseFloat(g[5]),!0,n-1),g_pog_index=n-1,g_scene=t,g_camera=o,render(n-1)}}g_pog_index=t,"Y"==g_isReportRender&&($("#wpdSplitter_splitter_second")[0].style.setProperty("display","block","important"),$("#maincanvas2-btns, #productInfoMainCont, .a-Splitter-barH").css("visibility","visible")),g_isReportRender="Y",setTimeout((function(){$(".a-Splitter-barH").removeClass("is-active is-focused")}),100)}function set_item_blink(e){logDebug("function : set_item_blink","S");try{var t=0;if(g_multiselect="Y","undefined"!=typeof g_pog_json&&g_pog_json.length>0){if(g_intersected)for(var o=0;o<g_intersected.length;o++)g_select_color=g_intersected[o].BorderColour,g_intersected[o].WireframeObj.material.color.setHex(g_intersected[o].BorderColour),"Y"==g_intersected[o].ImageExists&&"Y"==g_show_live_image&&(g_intersected[o].WireframeObj.material.transparent=!0,g_intersected[o].WireframeObj.material.opacity=.0025);if(g_intersected=[],g_delete_details=[],void 0!==e){for(o=0;o<e.length;o++){t=0;for(const r of g_pog_json){var n=0;for(const g of r.ModuleInfo){if(null==g.ParentModule||"undefined"==g.ParentModule){var s=0;for(const r of g.ShelfInfo){if(void 0!==r&&"NOTCH"!==r.ObjType&&"BASE"!==r.ObjType&&"DIVIDER"!==r.ObjType&&"TEXTBOX"!==r.ObjType){var _=0;for(const c of r.ItemInfo){if(c.Item==e[o].getAttribute("data-id")){var l=g_scene_objects[t].scene.children[2].getObjectById(c.ObjID);g_intersected.push(l);var a={};if(a.p_pog_index=t,a.ObjID=c.ObjID,a.MIndex=n,a.SIndex=s,a.ObjWidth=c.W,a.ObjHeight=c.H,a.XAxis=c.X,a.YAxis=c.Y,a.ZAxis=c.Z,a.IIndex=_,a.ObjType=r.ObjType,a.IsDivider="N",a.Object="ITEM",a.MObjID=g.MObjID,a.SObjID=r.SObjID,a.ItemID=c.ItemID,a.Item=c.Item,a.W=c.W,a.H=c.H,a.X=c.X,a.Y=c.Y,a.RW=c.RW,a.Exists="N",a.Rotation=0,a.Slope=0,a.Distance=c.Distance,a.TopObjID=c.TopObjID,a.BottomObjID=c.BottomObjID,g_delete_details.multi_delete_shelf_ind="",g_delete_details.push(a),void 0!==s&&void 0!==n&&g_delete_details.length>0){var i=g_pog_json[t].ModuleInfo[n].ShelfInfo[s];g_delete_details[g_delete_details.length-1].ShelfInfo=[],g_delete_details[g_delete_details.length-1].ShelfInfo.push(i)}}_++}}s++}}n++}t++}}render_animate_selected()}}logDebug("function : set_item_blink","E")}catch(e){error_handling(e)}}function setUpItemBlink(){$("#item_detail_grid .a-GV-w-scroll tbody tr").click((function(){var e=$(this),t=[];g_lastSelectedRow=e,$("#item_detail_grid .a-GV-w-scroll tr.selected").removeClass("selected"),$(this).addClass("selected"),void 0!==(t=$("#item_detail_grid .a-GV-w-scroll tr.selected"))&&(set_item_blink(t),g_productselect="Y"),setTimeout((function(){$("#item_detail_grid_ig_grid_vc_status").html(apex.lang.formatMessage("APEX.GV.SELECTION_COUNT",$("#item_detail_grid .a-GV-w-scroll tbody tr.selected").length))}),200)}))}